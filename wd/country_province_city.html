<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>国家、省、市三级联动JS源码</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript" src="cpcData.js"></script>
<script type="text/javascript">
    
    /*var s=["s1","s2","s3","s4"];
    var opt0 = ["国家","省/州","市","县"];*/
    var s=["s1","s2","s3"];
    var opt0 = ["国家","省/州","市"];
    function setup(){
        for(i=0;i <s.length-1;i++){
            document.getElementById(s[i]).onchange = new Function("change("+(i+1)+")")
        }
       
        change(0);
    }
    function change(v){
        var str="0";
        for(i=0;i <v;i++){ 
            str+=("_"+(document.getElementById(s[i]).selectedIndex-1));
        };
        var ss=document.getElementById(s[v]);
        with(ss){
            length = 0;
            options[0]=new Option(opt0[v],opt0[v]);
            if(v && document.getElementById(s[v-1]).selectedIndex>0 || !v){
                if(dsy.Exists(str)){
                    ar = dsy.Items[str];
                    for(i=0;i <ar.length;i++)options[length]=new Option(ar[i],ar[i]);
                    if(v)options[1].selected = true;
                }
            }
            if(++v <s.length){change(v);}
        }
    }
    window.onload = function(){
        setup();
    }
</SCRIPT>
</head>
<body >
<form name='frm'>
    <select id="s1"> <option>国家 </option> </select>
    <select id="s2"> <option>省、州 </option> </select>
    <select id="s3"> <option>地级市 </option> </select>
    <!-- <select id="s4"> <option>县 </option> </select> -->
</form>
</body>
</html>