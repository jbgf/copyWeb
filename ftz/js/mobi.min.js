if (typeof Mobi == "undefined") {
	Mobi = {}
}
Mobi.getPreviewWindow = function() {
	var b = Fai.top.document.getElementById("mobiReviewPageFrame");
	var a = !b ? window : b.contentWindow;
	return a
};
Mobi.getPreviewDocument = function() {
	var a = Mobi.getPreviewWindow().document;
	return a
};
Mobi.getPreviewObject = function(a) {
	if (!a) {
		return
	}
	return Mobi.getPreviewDocument().getElementById(a)
};
Mobi.getPreviewObjectClass = function(a) {
	if (!a) {
		return
	}
	return Mobi.getPreviewDocument().getElementsByClassName(a)
};
Mobi.getJQMobi = function() {
	var b = Mobi.getPreviewWindow(),
		a = b.jm;
	return a
};
Mobi.bindTouchAndClickEvent = function(a, b) {
	if (jm.os.supportsTouch) {
		a.unbind("touchstart");
		a.bind("touchstart", b)
	} else {
		a.unbind("mousedown");
		a.bind("mousedown", b)
	}
};
Mobi.onTouchAndClickEvent = function(a, b) {
	if (jm.os.supportsTouch) {
		jm("body").off("touchstart", a);
		jm("body").on("touchstart", a, b)
	} else {
		jm("body").off("mousedown", a);
		jm("body").on("mousedown", a, b)
	}
};
Mobi.autoFixGWebTop = function(e) {
	var j = Mobi.webTop(),
		f = Mobi.getPreviewObject("g_web"),
		i = Mobi.getPreviewObject("webTop"),
		h = Mobi.getPreviewObject("webBodyBackground"),
		d = Mobi.getPreviewObject("webHeaderBox");
	d.style.top = "";
	i.style.top = "";
	if (e !== 2 && e !== 7 && e !== 8) {
		var c = Mobi.getPreviewObject("fk-gWebPlaceholdPT");
		if (c) {
			c.style.height = j + "px"
		} else {
			c = jm("<div id='fk-gWebPlaceholdPT' style='height:" + j + "px;'></div>");
			jm(f).prepend(c)
		}
		return
	}
	if (e == 7) {
		var b = jm("#webHeader"),
			a = Mobi.getPreviewObject("navbar");
		if (j > 0) {
			a.style.top = j + "px"
		}
		if (b.css("display") === "none") {
			return
		}
	}
	d.style.top = j + "px";
	i.style.top = j + "px";
	var c = Mobi.getPreviewObject("fk-gWebPlaceholdPT");
	if (c) {
		c.style.height = (d.offsetHeight + j) + "px"
	} else {
		c = jm("<div id='fk-gWebPlaceholdPT' style='height:" + (d.offsetHeight + j) + "px;'></div>");
		jm(f).prepend(c)
	}
};
Mobi.webTop = function() {
	var b = 0,
		a = Mobi.getPreviewObject("mobiTipsMarquee");
	if (!a) {
		return b
	} else {
		var c = Mobi.getPreviewObject("webTips").offsetHeight;
		b = c;
		return b
	}
};

Mobi.navSwipeMenu = function(a) {
	var b = "navButton";
	c("moveAnimation");

	function c(f) {
		jm("#webBannerBox").addClass(f);
		jm("#webContainerBox").addClass(f);
		jm("#customerServiceDiv").addClass(f);
		jm("#webFooter").addClass(f);
		jm("#bgm_icon").addClass(f)
	}
	function e(f) {
		jm("#webHeaderBox").removeClass(f);
		jm("#webBannerBox").removeClass(f);
		jm("#webContainerBox").removeClass(f);
		jm("#customerServiceDiv").removeClass(f);
		jm("#webFooter").removeClass(f);
		jm("#bgm_icon").removeClass(f)
	}
	function d(h) {
		var f = Mobi.getPreviewObject("navbar").className;
		if (f.indexOf("open") !== -1) {
			jm("#navbar").removeClass("open");
			jm("#navExistOffPanel").removeClass("navPanelOpen");
			jm("#navButton").removeClass("navButtonOpen");
			e("moveRight");
			if (a === 2) {
				jm("#webTop").css("height", "")
			}
		} else {
			jm("#navbar").addClass("open");
			jm("#navExistOffPanel").addClass("navPanelOpen");
			jm("#navButton").addClass("navButtonOpen");
			c("moveRight");
			if (a === 2) {
				jm("#webTop").css("height", "100%")
			}
		}
	}
	if (a != 5 && a != 2 && a !== 8) {
		Mobi.autoSetNavBarHeight(a)
	}
	Mobi.bindTouchAndClickEvent(jm("#" + b), function() {
		d();
		return false
	});
	Mobi.bindTouchAndClickEvent(jm("#navExistOffPanel"), function() {
		d();
		return false
	})
};
Mobi.initTemplate2 = function(f) {
	var e = Mobi.getJQMobi(),
		a = f.layout,
		h = f.moduleStyle,
		d = f.designType,
		c = Mobi.getPreviewObject("navbar"),
		b = Mobi.getPreviewObject("navbarList");
	if (c) {
		c.setAttribute("style", "")
	}
	if (b) {
		b.setAttribute("style", "")
	}
	jm(Mobi.getPreviewObject("webTop")).css("height", "");
	
		if (a == 2 || a == 4 || a == 5 || a == 7) {
			if (a !== 5 && a !== 7) {
				Mobi.getPreviewObject("webTop").appendChild(Mobi.getPreviewObject("navbar"))
			} else {
				Mobi.getPreviewObject("webHeaderBox").appendChild(Mobi.getPreviewObject("navbar"))
			}
			
			Mobi.navSwipeMenu(a)
		} 
	
	
	Mobi.autoFixGWebTop(a);
	
	if (Mobi.getPreviewObject("webMultilingualArea")) {
		if (a == 4) {
			jm(Mobi.getPreviewObject("webHeaderBox")).append(Mobi.getPreviewObject("webMultilingualArea"))
		} else {
			jm(Mobi.getPreviewObject("webBannerBox")).prepend(Mobi.getPreviewObject("webMultilingualArea"))
		}
	}
	if (Fai.top._templateFrameId === 1005 || Fai.top._templateFrameId === 1004) {
		Mobi.scrollNavFix();
		jm(window).bind("load", function() {
			Mobi.scrollNavFix()
		})
	}
	if (Fai.top._templateFrameId === 1004) {
		jm(Mobi.getPreviewObject("navbar")).append(Mobi.getPreviewObject("navButton"))
	} else {
		jm(Mobi.getPreviewObject("webHeaderBox")).prepend(Mobi.getPreviewObject("navButton"))
	}
	
};


Mobi.autoSetNavBarHeight = function(a) {
	var f = Mobi.getPreviewObject("webHeader").offsetHeight,
		d = Mobi.getPreviewObject("webTips") ? Mobi.getPreviewObject("webTips").offsetHeight : 0,
		c = 0,
		e = 4 + parseInt(jm(Mobi.getPreviewObject("navbar")).css("bottom").replace("px", ""));
	if (jm.os.iphone) {
		if (a == 4) {
			c = Mobi.getPreviewWindow().innerHeight - e - d;
			if (c > 370) {
				c = 370
			}
		}
	} else {
		if (jm.os.android) {
			c = Mobi.getPreviewWindow().screen.height / Mobi.getPreviewWindow().devicePixelRatio - Mobi.getPreviewWindow().screenTop;
			if (a == 4) {
				c = c - e;
				if (c > 370) {
					c = 370
				}
			}
		} else {
			if (!jm.os.supportsTouch) {
				c = Mobi.getPreviewWindow().innerHeight - d;
				if (a == 4) {
					c = Mobi.getPreviewWindow().innerHeight - e;
					if (c > 350) {
						c = 350
					}
				}
			}
		}
	}
	if (c > 0) {
		if (a == 4) {
			var b = parseInt(jm("#navbarList").height()) + parseInt(jm("#navbarList").css("padding-bottom").replace("px", ""));
			if (b > c) {
				jm("#navbar").css("height", c + "px")
			}
		} else {
			jm("#navbar").css("height", c + "px")
		}
	}
};
Mobi.initMobiPage = function(a) {
	if (!jm.os.supportsTouch) {
		Mobi.resetHtmlFontSize()
	}
	Mobi.initTemplate2(a);
	
	
	
	window.onresize = function() {
		
		Mobi.resetHtmlFontSize();
		Mobi.autoFixGWebTop(Fai.top._templateLayoutId);
		
	};
	
	
	
	
};
Mobi.resetHtmlFontSize = function() {
	var a = document.documentElement ? document.documentElement.clientWidth : document.body.clientWidth;
	if (a > 640) {
		a = 640
	}
	document.documentElement.style.fontSize = a * 1 / 16 + "px";
	_htmlFontSize = a * 1 / 16
};


